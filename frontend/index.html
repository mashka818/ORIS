<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Онлайн‑запись</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <header class="app-header">
      <div class="container header-inner">
        <div class="brand">Виджет онлайн‑записи</div>
        <div class="header-actions">
          <div class="custom-select" id="customLangSelect">
            <div class="select-selected">RU</div>
            <div class="select-items select-hide">
              <div data-value="ru">RU</div>
              <div data-value="en">EN</div>
              <div data-value="uz">UZ</div>
              <div data-value="tj">TJ</div>
            </div>
          </div>
          <label class="theme-switch" aria-label="Переключить тему">
            <input type="checkbox" id="themeToggle">
            <div class="toggle">
              <div class="cloud"></div>
              <div class="star"></div>
              <div class="sea"></div>
              <div class="mountains"></div>
            </div>
          </label>
          <button id="adminBtn" class="admin-btn">Войти</button>
          <button id="logoutBtn" class="admin-btn" style="display:none">Выйти</button>
        </div>
      </div>
    </header>

    <!-- Welcome Section -->
    <section id="welcomeSection" class="welcome-section">
      <div class="container welcome-content">
        <h1 class="welcome-title" data-i18n="welcomeTitle">Добро пожаловать!</h1>
        <p class="welcome-text" data-i18n="welcomeText">Запишитесь на медицинский осмотр</p>
        <button class="primary large" id="startBooking" data-i18n="startBooking">Начать запись</button>
      </div>
    </section>

    <!-- Booking Section -->
    <main class="container layout" id="bookingSection" style="display:none">
      <section class="calendar-card" id="calendarCard">
        <div class="calendar-header">
          <button class="nav-btn" id="prevMonth" aria-label="Предыдущий месяц">‹</button>
          <div class="month-label" id="monthLabel"></div>
          <button class="nav-btn" id="nextMonth" aria-label="Следующий месяц">›</button>
        </div>
        <div class="calendar-grid" id="calendarGrid" aria-label="Календарь"></div>

        <div class="slots">
          <div class="slots-group">
            <div class="slots-title" data-i18n="day">День</div>
            <div class="slot-list" id="daySlots"></div>
          </div>
          <div class="slots-group">
            <div class="slots-title" data-i18n="evening">Вечер</div>
            <div class="slot-list" id="eveningSlots"></div>
          </div>
        </div>
      </section>

      <aside class="form-card" id="formCard">
        <h2 data-i18n="formTitle">Запись на прием</h2>
        <form id="bookingForm">
          <div class="input-row">
            <label data-i18n="clinic">Выберите клинику</label>
            <div class="custom-select clinic-select" id="customClinicSelect">
              <div class="select-selected" data-i18n="selectClinic">Выберите клинику</div>
              <div class="select-items select-hide" id="clinicSelectItems">
                <!-- Клиники будут загружены динамически -->
              </div>
            </div>
            <span class="error-msg" id="clinicError"></span>
          </div>
          <div class="input-row">
            <label for="name" data-i18n="name">Имя</label>
            <input id="name" name="name" type="text" placeholder="Иван Иванов" required />
            <span class="error-msg" id="nameError"></span>
          </div>
          <div class="input-row">
            <label for="phone" data-i18n="phone">Телефон</label>
            <input id="phone" name="phone" type="tel" placeholder="+7 900 000‑00‑00" required />
            <span class="error-msg" id="phoneError"></span>
          </div>
          <div class="selected-slot" id="selectedSlot" data-i18n="noSlot">Выберите дату и время</div>
          <button class="primary" type="submit" disabled id="submitBtn" data-i18n="book">Записаться</button>
          <div class="hint" data-i18n="privacy">Отправляя заявку, вы соглашаетесь с обработкой персональных данных</div>
        </form>
      </aside>
    </main>

    <!-- Toast Notification -->
    <div class="toast" id="toast" role="status" aria-live="polite"></div>

    <!-- Admin Panel -->
    <main class="container admin-layout" id="adminSection" style="display:none">
      <section class="calendar-card">
        <h2>Административная панель</h2>
        
        <!-- Tabs -->
        <div class="admin-tabs">
          <button class="admin-tab active" data-tab="bookings" data-i18n="bookings">Записи</button>
          <button class="admin-tab" data-tab="statistics" data-i18n="statistics">Статистика</button>
          <button class="admin-tab" data-tab="test" data-i18n="testTools">Тестовые инструменты</button>
        </div>

        <!-- Bookings Tab -->
        <div id="tabBookings" class="tab-content active">
          <div class="toolbar">
            <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap">
              <div class="custom-date-picker" id="customDatePicker">
                <div class="date-selected" id="dateSelected">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                    <line x1="16" y1="2" x2="16" y2="6"/>
                    <line x1="8" y1="2" x2="8" y2="6"/>
                    <line x1="3" y1="10" x2="21" y2="10"/>
                  </svg>
                  <span id="dateText" data-i18n="selectDate">Выбрать дату</span>
                </div>
                <div class="date-dropdown select-hide" id="dateDropdown">
                  <div class="mini-calendar">
                    <div class="mini-calendar-header">
                      <button class="mini-nav-btn" id="miniPrevMonth">‹</button>
                      <div class="mini-month-label" id="miniMonthLabel"></div>
                      <button class="mini-nav-btn" id="miniNextMonth">›</button>
                    </div>
                    <div class="mini-calendar-grid" id="miniCalendarGrid"></div>
                  </div>
                  <input type="hidden" id="dateFilter" />
                </div>
              </div>
              <div class="custom-select clinic-filter-select" id="customClinicFilter">
                <div class="select-selected">Все клиники</div>
                <div class="select-items select-hide" id="clinicFilterItems">
                  <div data-value="">Все клиники</div>
                </div>
              </div>
              <button class="ghost" id="clearFilter">Сбросить</button>
            </div>
          </div>
          <div id="bookingsList"></div>
        </div>

        <!-- Statistics Tab -->
        <div id="tabStatistics" class="tab-content">
          <div style="margin-bottom: 20px;">
            <div class="custom-select clinic-filter-select" id="customStatsClinicFilter" style="margin-bottom: 16px;">
              <div class="select-selected">Все клиники</div>
              <div class="select-items select-hide" id="statsClinicFilterItems">
                <div data-value="">Все клиники</div>
              </div>
            </div>
          </div>
          <div class="stats-filters">
            <button class="stats-filter active" data-period="all" data-i18n="filterAll">Все время</button>
            <button class="stats-filter" data-period="day" data-i18n="filterDay">День</button>
            <button class="stats-filter" data-period="week" data-i18n="filterWeek">Неделя</button>
            <button class="stats-filter" data-period="month" data-i18n="filterMonth">Месяц</button>
            <button class="stats-filter" data-period="year" data-i18n="filterYear">Год</button>
          </div>
          <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
              <div class="stat-label" data-i18n="totalBookings">Всего записей</div>
              <div class="stat-value" id="statTotal">0</div>
            </div>
            <div class="stat-card stat-success">
              <div class="stat-label" data-i18n="attendedCount">Пришли</div>
              <div class="stat-value" id="statAttended">0</div>
            </div>
            <div class="stat-card stat-danger">
              <div class="stat-label" data-i18n="notAttendedCount">Не пришли</div>
              <div class="stat-value" id="statNotAttended">0</div>
            </div>
            <div class="stat-card stat-warning">
              <div class="stat-label" data-i18n="pendingCount">Ожидают</div>
              <div class="stat-value" id="statPending">0</div>
            </div>
          </div>
        </div>

        <!-- Test Tools Tab -->
        <div id="tabTest" class="tab-content">
          <div class="test-tools">
            <button class="ghost danger" id="btnDeleteAll" data-i18n="deleteAll">Удалить все заявки</button>
            <button class="ghost" id="btnFillSlot" data-i18n="fillSlot">Заполнить слот 9:00-9:30 23 числа</button>
            <button class="ghost" id="btnFillDay" data-i18n="fillDay">Заполнить весь день</button>
          </div>
        </div>
      </section>
    </main>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 data-i18n="adminLogin">Вход в админ-панель</h2>
          <button class="modal-close" id="closeModal">&times;</button>
        </div>
        <form id="loginForm">
          <div class="input-row">
            <label for="username" data-i18n="username">Логин</label>
            <input id="username" name="username" type="text" placeholder="admin" required />
          </div>
          <div class="input-row">
            <label for="password" data-i18n="password">Пароль</label>
            <input id="password" name="password" type="password" placeholder="••••••••" required />
          </div>
          <div class="error-msg" id="loginError"></div>
          <button class="primary" type="submit" data-i18n="login">Войти</button>
        </form>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
